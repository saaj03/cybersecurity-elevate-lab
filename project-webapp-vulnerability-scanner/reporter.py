import json
import csv

def save_json(results, filename="report.json"):
    """Save scan results to JSON"""
    with open(filename, "w") as f:
        json.dump(results, f, indent=2)

def save_csv(results, filename="report.csv"):
    """Save scan results to CSV"""
    with open(filename, "w", newline="") as f:
        writer = csv.writer(f)
        writer.writerow(["Vulnerability", "Tested URL", "Payload / Detail"])
        for row in results:
            writer.writerow(row)

def save_html(results, filename="report.html"):
    """Save scan results to HTML table"""
    with open(filename, "w") as f:
        f.write("<html><body>")
        f.write("<h2>Scan Report</h2>")
        if results:
            f.write("<table border='1' cellpadding='5'>")
            f.write("<tr><th>Vulnerability</th><th>Tested URL</th><th>Payload / Detail</th></tr>")
            for vuln, url, payload in results:
                f.write(f"<tr><td>{vuln}</td><td>{url}</td><td>{payload}</td></tr>")
            f.write("</table>")
        else:
            f.write("<p>No vulnerabilities found.</p>")
        f.write("</body></html>")
